<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>路人-戊</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="this is a test">
<meta property="og:type" content="website">
<meta property="og:title" content="路人-戊">
<meta property="og:url" content="http://luren5.com/page/8/index.html">
<meta property="og:site_name" content="路人-戊">
<meta property="og:description" content="this is a test">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="路人-戊">
<meta name="twitter:description" content="this is a test">
  
  
    <link rel="icon" href="favicon.png">
  
  <link href='//fonts.useso.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
  <link href="//fonts.useso.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css" type="text/css">
  

  
</head>
<body>
  <div id="container">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="/" id="logo"><i class="logo" style="background-image: url(/css/images/logo.png)"></i><span class="site-title">路人-戊</span></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/.">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="/css/images/avatar.png"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
      
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"> </button><input type="hidden" name="sitesearch" value="http://luren5.com"></form>
      </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tr>
        
          <td><a class="main-nav-link" href="/.">Home</a></td>
        
          <td><a class="main-nav-link" href="/archives">Archives</a></td>
        
          <td><a class="main-nav-link" href="/categories">Categories</a></td>
        
          <td><a class="main-nav-link" href="/tags">Tags</a></td>
        
          <td><a class="main-nav-link" href="/about">About</a></td>
        
        <td>
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="http://luren5.com"></form>
        </td>
      </tr>
    </table>
  </div>
</header>


    <div class="outer">
      
        <aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      <img id="avatar" src="/css/images/avatar.png">
      <h2 id="name">路人-戊</h2>
      <h3 id="title">Software Engineer</h3>
      <span id="location"><i class="fa fa-map-marker"></i>中国北京</span>
      <a id="follow" href="https://github.com/minishine/">关注我</a>
    </div>
    <div class="article-info profile-block">
      <div class="article-info-block">
        44
        <span>文章</span>
      </div>
      <div class="article-info-block">
        54
        <span>标签</span>
      </div>
    </div>
    
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
          
          <td><a href="http://github.com/minishine/" target="_blank" title="github"><i class="fa fa-github"></i></a></td>
          
          <td><a href="https://www.facebook.com/huanhuan.xu.73" target="_blank" title="facebook"><i class="fa fa-facebook"></i></a></td>
          
          <td><a href="http://weibo.com/hjhuanhuan" target="_blank" title="weibo"><i class="fa fa-weibo"></i></a></td>
          
          <td><a href="mailto:minishine90@gmail.com" target="_blank" title="mail"><i class="fa fa-mail"></i></a></td>
          
        </tr>
      </table>
    </div>
    
    
  </div>
</aside>

      
      <section id="main">
      <article id="post-设计模式分享" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/03/03/设计模式分享/">设计模式分享</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/03/03/设计模式分享/">
      <time datetime="2015-03-03T04:09:26.000Z" itemprop="datePublished">2015-03-03</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Tech-Doc/">Tech Doc</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>mark~在新浪的时候，一个小组技术分享会</p>
<h3 id="什么是设计模式？">什么是设计模式？</h3><p>设计模式是一套代码设计经验的总结</p>
<h3 id="为什么要提倡“Design_Pattern“">为什么要提倡“Design Pattern“</h3><p>根本原因是为了代码复用，增加可维护性</p>
<h3 id="几个误区">几个误区</h3><p>设计模式并非起源于计算机科学，而是建筑学</p>
<h3 id="设计模式并非只有23种">设计模式并非只有23种</h3><p>设计模式并不只适用于面向对象</p>
<h3 id="面向对象设计的5大原则">面向对象设计的5大原则</h3><h4 id="1）单一职责原则">1）单一职责原则</h4><p> 避免相同的职责分散到不同的类中；避免一个类承担太多的职责<br> eg:活字印刷术，拆分成词？<br> 工厂模式，只负责生产对象，但是不负责对象的具体实现</p>
<h4 id="2）接口隔离原则">2）接口隔离原则</h4><p> 一个类对另一个类的依赖性应当是建立在最小的接口上的；客户端程序不应该依赖它不需要的接口方法<br> eg: 缓存基类，（连接、关闭，get、set操作）但是不应该有（zset、zget）此类操作<br> 多继承防止胖接口， 或者考虑组合</p>
<h4 id="3）开放封闭原则">3）开放封闭原则</h4><p> 一个模块在可扩展性方面应该是开放的，在可更改方面应该是封闭的<br> eg: 电脑组装的案例</p>
<h4 id="4）里氏替换原则">4）里氏替换原则</h4><p> 子类必须能够替换掉它们的父类型、并出现在父类能够出现的任何地方<br> eg: 手机 到  智能机    （最基本的电话短信功能，可以添加任何其它功能  mp3，导航等，它依然是手机，但是如果它不能打电话发短信呢？最多是个pad）</p>
<h4 id="5）依赖倒置原则">5）依赖倒置原则</h4><p> 上层模块不应该依赖于下层模块 ，它们共同依赖于一个抽象（父类不能依赖于子类，它们都要依赖抽象类），抽象不应该依赖于具体，具体应该依赖于抽象<br> 因为抽象是相对稳定，不易变化的<br> eg: 给前端同事提供接口，基类两个抽象方法 （接收并检查参数，返回约定格式的结果）  那么不管你是怎么具体来实现的，谁来实现，都应该依赖于这个抽象</p>
<h3 id="设计模式的分类，总体来说设计模式分为三大类：">设计模式的分类，总体来说设计模式分为三大类：</h3><p>  创建型模式，共五种</p>
<p>  工厂模式、抽象工厂模式、单例模式、建造者模式、原型模式。</p>
<p>  结构型模式，共七种</p>
<p>  适配器模式、装饰器模式、代理模式、外观模式、桥接模式、组合模式、享元模式。</p>
<p>  行为型模式，共十一种</p>
<p>  策略模式、模板方法模式、观察者模式、迭代器模式、责任链模式、命令模式、备忘录模式、状态模式、访问者模式、中介者模式、解释器模式。</p>
<p>下面与大家分享10种常用的设计模式</p>
<p>1、单例模式</p>
<p>保证某个类只有一个实例</p>
<p>class  MysqlStorage {</p>
<p>private static $_instance = null;</p>
<p>public function __constant() {</p>
<p>// do something</p>
<p>}</p>
<p>public static function getInstance() {</p>
<p>if(self::$_instance == null ) {</p>
<p>self::$_instance = new MysqlStorage;</p>
<p>}</p>
<p>return  self::$_instance;</p>
<p>}</p>
<p>}</p>
<p>Q2：php是非常驻内存的，脚本执行完之后就释放所有内存，那么这个单例模式的好处是什么呢？</p>
<p> 2、工场模式</p>
<p> 创建对象的类</p>
<p> abstract class Operation {</p>
<p> abstract public function operate($num1, $num2);</p>
<p> }</p>
<p> class operationAdd extends Operation {</p>
<p> public function operate($num1, $num2) {</p>
<p> return $num1 + $num2;</p>
<p> }</p>
<p> }</p>
<p> class operationSub extends Operation {</p>
<p> public function operate($num1, $num2) {</p>
<p> return $num1 - $num2;</p>
<p> }</p>
<p> }</p>
<p> // ……</p>
<p> class Factory {</p>
<p> public static function createObj($operate) {</p>
<p> $class = “operation”.ucfirst(strtolower($operate));</p>
<p> return new $class;</p>
<p> }</p>
<p> }</p>
<p> $test = Factory::createObj(‘add’);</p>
<p> echo $test-&gt;operate(23, 0);</p>
<p> 如果我们再添加一个 取余运算，传统的方法会让switch分支添加，代码庞杂，不易维护。如果用工厂模式直接再添加一个运算类继承基类，这样就避免修改原来的代码，很好的实现 开放封闭原则、而工厂类只负责对象的生产，而不负责对象的具体实现，也体现了单一职责原则。</p>
<p>  3）、抽象工厂模式</p>
<p>  抽象工厂模式是工厂方法模式的升级版本，他用来创建一组相关或者相互依赖的对象。</p>
<p>  他与工厂方法模式的区别就在于，工厂模式针对的是一个产品等级结构；而抽象工厂模式则是针对的多个产品等级结构。</p>
<p>  也就是说，工厂方法模式提供的所有产品都是衍生自同一个接口或抽象类，而抽象工厂模式所提供的产品则是衍生自不同的接口或抽象类。</p>
<p>  产品族的概念：所谓的产品族，是指位于不同产品等级结构中功能相关联的产品组成的家族</p>
<p>   抽象工厂模式所提供的一系列产品就组成一个产品族；</p>
<p>   abstract class Engine {</p>
<p>   public function get(){}</p>
<p>   }</p>
<p>   //轿车引擎</p>
<p>   class CarEngine extends Engine{</p>
<p>   public function get(){</p>
<p>   echo ‘get car engine’;</p>
<p>   }</p>
<p>   }</p>
<p>   //巴士引擎</p>
<p>   class BusEngine extends Engine{</p>
<p>   public function get(){</p>
<p>   echo ‘get bus engine’;</p>
<p>   }</p>
<p>   }</p>
<p>   //车轮</p>
<p>   abstract class Wheel{</p>
<pre><code><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span><span class="params">()</span></span>{}
</code></pre><p> }</p>
<p> //轿车车轮</p>
<p> class CarWheel extends Wheel{</p>
<p>   public function get(){</p>
<pre><code>  <span class="built_in">echo</span> <span class="string">'get car wheel'</span>;

}
</code></pre><p>}</p>
<p>//巴士车轮</p>
<p>class BusWheel extends Wheel{</p>
<p>   public function get(){</p>
<pre><code> <span class="built_in">echo</span> <span class="string">'get bus wheel'</span>;

}
</code></pre><p> }</p>
<p> //工厂</p>
<p> abstract class Factory {</p>
<p> public static function create($class){}</p>
<p> }</p>
<p> //轿车工厂</p>
<p> class CarFactory extends Factory{</p>
<p> public static function create($class){</p>
<p> $class = ‘Car’.$class;</p>
<p> return new $class;</p>
<p> }</p>
<p> }</p>
<p> //巴士工厂</p>
<p> class BusFactory extends Factory{</p>
<p> public static function create($class){</p>
<p> $class = ‘Bus’.$class;</p>
<p> return new $class;</p>
<p> }</p>
<p> }</p>
<p> //使用例子：创建轿车的轮子，巴士的引擎</p>
<p> CarFactory::create(“Wheel”)-&gt;get();</p>
<p> BusFactory::create(“Engine”)-&gt;get();</p>
<p> 适用场景<br> 当需要创建的对象是一系列相互关联或相互依赖的产品族时，便可以使用抽象工厂模式。说的更明白一点，就是一个继承体系中，如果存在着多个等级结构（即存在着多个抽象类），并且分属各个等级结构中的实现类之间存在着一定的关联或者约束，就可以使用抽象工厂模式。</p>
<p> 假如各个等级结构中的实现类之间不存在关联或约束，则使用多个独立的工厂来对产品进行创建，则更合适一点。</p>
<p>  4）、观察者模式</p>
<p>  定义对象之间一对多的关系，当被观察的对象状态发生改变的时候，所有观察它的对象都会得到提醒并做出相应的改变</p>
<p>  class Location{</p>
<p>  private $_observers = array();</p>
<p>   public function register($sub){ /<em>  注册观察者 </em>/</p>
<p>   $this-&gt;_observers[] = $sub;</p>
<p>   }</p>
<p>   public function trigger(){  /<em>  统一得到更新  </em>/</p>
<p>   if(!empty($this-&gt;_observers)){</p>
<p>   foreach($this-&gt;_observers as $observer){</p>
<p>   $observer-&gt;update();</p>
<p>   }</p>
<p>   }</p>
<p>   }</p>
<p>   }</p>
<p>   interface Observerable{</p>
<p>   public function update();</p>
<p>   }</p>
<p>   class Subscriber implements Observerable{</p>
<p>   public function update(){</p>
<p>   echo “Callbackn”;</p>
<p>   }</p>
<p>   }</p>
<p>   $location-&gt;register(new Subscriber());</p>
<p>   $location-&gt;register(new Subscriber1());</p>
<p>   $location-&gt;register(new Subscriber2());</p>
<p>   $paper-&gt;trigger();</p>
<p>   eg: 这是一种很常见的设计模式，比如美团客户端。  位置对象（获取当前的地理坐标），酒店Obj、美食Obj、KTV Obj等都观察位置对象，如果位置对象发生改变，那些这些观察它的对象也要相应发生变化</p>
<p>5）、策略模式</p>
<p>定义一系列的算法,把每一个算法封装起来, 并且使它们可相互替换。策略模式使得算法可独立于使用它的客户而变化。</p>
<p>interface yueHui {</p>
<p>public function eat();</p>
<p>}</p>
<p>//策略A</p>
<p>class StrategyA implements yueHui {</p>
<p>public function eat() {</p>
<p>echo “我们去吃海底捞吧！”;</p>
<p>}</p>
<p>}</p>
<p> class StrategyB implements yueHui {</p>
<p> public function eat() {</p>
<p> echo “我们去吃麻辣烫吧，6块钱的那种！”;</p>
<p> }</p>
<p> }</p>
<p>  // 环境类</p>
<p>  class ownContext {</p>
<p>  private $_strategy = null;</p>
<p>  public function __construct(yueHui $strategy) {</p>
<p>  $this-&gt;_strategy = $strategy;</p>
<p>  }</p>
<p>  public function eat() {</p>
<p>  $this-&gt;_strategy-&gt;eat();</p>
<p>  }</p>
<p>  }</p>
<p>  // 含蓄性妹子，使用策略A</p>
<p>  $oc = new ownContext(new StrategyA);</p>
<p>  $oc-&gt;eat();</p>
<p>  // 奔放性妹子，使用策略B</p>
<p>  $oc = new ownContext(new StrategyB);</p>
<p>  $oc-&gt;eat();</p>
<p>   6) 迭代器模式</p>
<p>   迭代器模式提供一种访问一个容器对象中的各个元素，而又不暴露其内部细节的方法</p>
<p>   提供一种通过对象集合或对象数组封装迭代的方法。如果需要遍历集合中不同类型的对象，则使用这种模式尤为便利。</p>
<p>   使用迭代器可以对不同数据结构的集合封装，外部只需调用迭代器提供的接口即可，提高了应用的可扩展性。</p>
<p>   A、通过遍历数组的方法去遍历对象   <a href="http://php.net/manual/zh/language.oop5.iterations.php" target="_blank" rel="external">http://php.net/manual/zh/language.oop5.iterations.php</a></p>
<p>   a、直接遍历</p>
<p>   b、继承iterator接口，实现  current(), key(), next(), rewind(), valid()   这几个方法</p>
<p>   c、实现IteratorAggregate 接口以替代实现所有的 Iterator 方法</p>
<p>   IteratorAggregate 只需要实现一个方法IteratorAggregate::getIterator()，其应返回一个实现了 Iterator 的类的实例。</p>
<p>   d、使用反射api</p>
<p>   $reflect = new ReflectionObject($student);</p>
<p>   $props = $reflect-&gt;getProperties();   //  获取属性列表</p>
<p>   $m = $reflect-&gt;getMethods();  // 获取方法列表</p>
<p>   e、使用class函数</p>
<p>   get_object_vars($student);</p>
<p>   get_class_methods(get_class($student));</p>
<p>   B、遍历文件夹（递归，实现Iterator接口）</p>
<p>   a、递归</p>
<p>   b、使用DirectoryIterator类（已经实现了Iterator接口）</p>
<p>   $dir = new DirectoryIterator(dirname(<strong>FILE</strong>));</p>
<p>   foreach($dir as $fileinfo) {</p>
<p>   if(!$fileinfo-&gt;isDir()) {</p>
<p>   echo $fileinfo-&gt;getFilename(), “t”, $fileinfo-&gt;getSize(), PHP_EOL;</p>
<p>   }</p>
<p>   }</p>
<p>   7)   命令模式</p>
<p>   将一个请求封装为一个对象，从而你可用不同的请求对客户进行参数化；对请求排队或记录请求日志，以及支持可撤销操作。</p>
<p>   eg: 用户请求action(可能是 login、register、logout等操作)，命令模式可以干掉大量的if else 操作（或者 switch）</p>
<p>   interface ICommand {</p>
<p>   function onCommand($name, $args);</p>
<p>   }</p>
<p>   class LoginCommand implements ICommand {</p>
<p>   public function onCommand($name, $args) {</p>
<p>   if ($name != ‘login’) {</p>
<p>   return false;</p>
<p>   } else {</p>
<p>   // 执行登录命令</p>
<p>   }</p>
<p>   }</p>
<p>   }</p>
<p>   class RegisterCommand implements ICommand {</p>
<p>   public function onCommand($name, $args) {</p>
<p>   if ($name != ‘register’) {</p>
<p>   return false;</p>
<p>   } else {</p>
<p>   // 执行注册命令</p>
<p>   }</p>
<p>   }</p>
<p>   }</p>
<p>class CommandChain {</p>
<p>private $_commands = array();</p>
<p>public function addCommand($cmd) {</p>
<p>$this-&gt;_commands []= $cmd;</p>
<p>}</p>
<p>public function removeCommand() {</p>
<p>// 删除命令</p>
<p>}</p>
<p>public function runCommand($name, $args) {</p>
<p>foreach($this-&gt;_commands as $cmd) {</p>
<p>if ($cmd-&gt;onCommand($name, $args)) return;</p>
<p>}</p>
<p>}</p>
<p>}</p>
<p>$cc = new CommandChain();</p>
<p>$cc-&gt;addCommand(new LoginCommand());</p>
<p>$cc-&gt;addCommand(new RegisterCommand());</p>
<p>$cc-&gt;runCommand(‘login’, array(‘username’,  ‘password’));</p>
<p>$cc-&gt;runCommand(‘register’,  array(‘username’,  ‘password’));</p>
<p> 8）建造者模式</p>
<p> 将一个复杂对象的构造与它的表示分离，使同样的构建过程可以创建不同的表示</p>
<p> class Product {</p>
<p> public $_type  = null;</p>
<p> public $_price = null;</p>
<p> public $_color = null;</p>
<p> public function setType($type) {</p>
<p> echo ‘set the type of the product,’;</p>
<p> $this-&gt;_type = $type;</p>
<p> }</p>
<p> public function setPrice($price)  {</p>
<p> echo ‘set the price of the product,’;</p>
<p> $this-&gt;_price = $price;</p>
<p> }</p>
<p> public function setColor($color)  {</p>
<p> echo ‘set the color of the product,’;</p>
<p> $this-&gt;_color = $color;</p>
<p> }</p>
<p> }</p>
<p>  $config = array(  ‘type’  =&gt; ‘shirt’,   ‘price’ =&gt; 100,  ‘color’ =&gt; ‘red’);</p>
<p>  class ProductBuilder</p>
<p>  {</p>
<p>  public $_config = null;</p>
<p>  public $_object = null;</p>
<p>  public function ProductBuilder($config)   {</p>
<p>  $this-&gt;_object = new Product();</p>
<p>  $this-&gt;_config = $config;</p>
<p>  }</p>
<p>  public function build()  {</p>
<p>  echo ‘<br>Using builder pattern:<br>‘;</p>
<p>  $this-&gt;_object-&gt;setType($this-&gt;_config[‘type’]);</p>
<p>  $this-&gt;_object-&gt;setPrice($this-&gt;_config[‘price’]);</p>
<p>  $this-&gt;_object-&gt;setColor($this-&gt;_config[‘color’]);</p>
<p>  }</p>
<p>  public function getProduct() {</p>
<p>  return $this-&gt;_object;</p>
<p>  }</p>
<p>  }</p>
<p>  $objBuilder = new ProductBuilder($config);</p>
<p>  $objBuilder-&gt;build();</p>
<p>  $objProduct = $objBuilder-&gt;getProduct();</p>
<p>  eg : 在创建不同的 数据库对象 实例的时候，构建的过程是一样的，但是可能因为db不同最后创建的实例不同</p>
<p>   9)外观模式</p>
<p>   为一个分层或一个子系统创建一个单一的入口 ， 外观设计模式隐藏了调用对象的复杂性。</p>
<p>   eg: liangliang 包接口</p>
<p>   class SubSystem1{</p>
<p>   public function method1(){</p>
<p>   echo ‘ SubSystem1 method1’;</p>
<p>   }</p>
<p>   }</p>
<p>   class SubSystem2{</p>
<p>   public function method2(){</p>
<p>   echo ‘ SubSystem2 method2’;</p>
<p>   }</p>
<p>   }</p>
<p>   class SubSystem3{</p>
<p>   public function method3(){</p>
<p>   echo ‘ SubSystem3 method3’;</p>
<p>   }</p>
<p>   }</p>
<p>class Facade{</p>
<p>private $_object1 = null;</p>
<p>private $_object2 = null;</p>
<p>private $_object3 = null;</p>
<p> public function __construct(){</p>
<p> $this-&gt;_object1 = new SubSystem1();</p>
<p> $this-&gt;_object2 = new SubSystem2();</p>
<p> $this-&gt;_object3 = new SubSystem3();</p>
<p> }</p>
<p>  public function methodA(){</p>
<p>  echo ‘Facade methodA ‘;</p>
<p>  $this-&gt;_object1-&gt;method1();</p>
<p>  $this-&gt;_object2-&gt;method2();</p>
<p>  }</p>
<p>   public function methodB(){</p>
<p>   echo ‘Facade methodB ‘;</p>
<p>   $this-&gt;_object2-&gt;method2();</p>
<p>   $this-&gt;_object3-&gt;method3();</p>
<p>   echo ‘<br>‘;</p>
<p>   }</p>
<p>   }</p>
<p>   $facade = new Facade();</p>
<p>   $facade-&gt;methodA();</p>
<p>   $facade-&gt;methodB();</p>
<p>10)  备忘录模式</p>
<p>在不破坏封装性的前提下,捕获一个对象的内部状态,并在该对象之外保存这个状态,这样以后就可以将该对象恢复到保存的状态</p>
<p>类对于对象而言是个模具， 同一类对象是具有相同的属性和方法，只是它们的属性值是不同的</p>
<p>eg: 爱迪生造电灯，不停的测试，材料为钨丝的时候感觉效果比较好，这个时候又把材料切换成bbb这种……最后还是发现铁丝的比较好，于是要还原原来的状态</p>
<p>class Light {</p>
<p>private $state = null;</p>
<p>public function __construct($state) {</p>
<p>$this-&gt;_state = $state;</p>
<p>}</p>
<p>//创建备忘录，将当前要保存的信息导入并实例化备忘录</p>
<p>public function createMemento() {</p>
<p>return new Memento($this-&gt;state);</p>
<p>}</p>
<p>//恢复备忘录，将Memento导入并将相关数据恢复</p>
<p>public function setMemento(Memento $memento) {</p>
<p>$this-&gt;state = $memento-&gt;state;</p>
<p>}</p>
<p>// 设置状态</p>
<p>public function setStatus($status) {</p>
<p>$this-&gt;_status = $status;</p>
<p>}</p>
<p>//展示状态数据</p>
<p>public function show() {</p>
<p>echo ‘当前状态是：’.$this-&gt;_state;</p>
<p>}</p>
<p>}</p>
<p>//备忘录类Memento</p>
<p>class Memento {</p>
<p>private $state;</p>
<p>public function __construct($state) {</p>
<p>$this-&gt;$_state = $state;</p>
<p>}</p>
<p>public function getState() {</p>
<p>return $this-&gt;_state;</p>
<p>}</p>
<p>}</p>
<p>//管理者类Caretaker</p>
<p>class Caretaker {</p>
<p>private $memento;</p>
<p>public function __set($key, $value) {</p>
<p>$this-&gt;$key = $value;</p>
<p>}</p>
<p>public function __get($key) {</p>
<p>if(isset($this-&gt;$key)) {</p>
<p>return $this-&gt;$key;</p>
<p>} else {</p>
<p>return NULL;</p>
<p>}</p>
<p>}</p>
<p>}</p>
<p>$light  = new  Light();</p>
<p>$light-&gt;setStatus(“钨”);</p>
<p>$light-&gt;show();  //初始状态为钨，比较好的状态</p>
<p>//创建备忘录并保存状态</p>
<p>$caretaker = new Caretaker();</p>
<p>$caretaker-&gt;memento = $light-&gt;createMemento();</p>
<p>//更改状态</p>
<p>$light-&gt;state = ‘铁’;</p>
<p>$light-&gt;show();</p>
<p>//恢复到原始状态</p>
<p>$light-&gt;setMemento($caretaker-&gt;memento);</p>
<p>$light-&gt;show();</p>
<p>?&gt;</p>
<p>最后，感谢大家！ 多有不足之处，烦请拍砖斧正…</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://luren5.com/2015/03/03/设计模式分享/" data-id="cirlw1yb10006cx379hkqzixl" class="article-share-link">分享到</a>
      
        <a href="http://luren5.com/2015/03/03/设计模式分享/#ds-thread" class="article-comment-link">评论</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-路人-戊正式搬家到gitpage" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/03/01/路人-戊正式搬家到gitpage/">路人-戊正式搬家到git page</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/03/01/路人-戊正式搬家到gitpage/">
      <time datetime="2015-03-01T02:47:44.000Z" itemprop="datePublished">2015-03-01</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/杂谈/">杂谈</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>mark一下<br>折腾了大半天，终于把博客迁移到git page. 为了跟进时代我也是蛮拼的!<br><img src="/pics/suolue.png" alt=""></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://luren5.com/2015/03/01/路人-戊正式搬家到gitpage/" data-id="cirlw1yas0003cx374th62w0c" class="article-share-link">分享到</a>
      
        <a href="http://luren5.com/2015/03/01/路人-戊正式搬家到gitpage/#ds-thread" class="article-comment-link">评论</a>
      
      
    </footer>
  </div>
  
</article>



    
      <nav id="page-nav">
        <a class="extend prev" rel="prev" href="/page/7/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span>
      </nav>
    </section>
      
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/CGI/" style="font-size: 10px;">CGI</a> <a href="/tags/FastCGI/" style="font-size: 10px;">FastCGI</a> <a href="/tags/Mysql/" style="font-size: 10px;">Mysql</a> <a href="/tags/NERDTree/" style="font-size: 10px;">NERDTree</a> <a href="/tags/PHP-CGI/" style="font-size: 10px;">PHP-CGI</a> <a href="/tags/PHP-FPM/" style="font-size: 10px;">PHP-FPM</a> <a href="/tags/RESideMenu/" style="font-size: 10px;">RESideMenu</a> <a href="/tags/Spawn-FCGI/" style="font-size: 10px;">Spawn-FCGI</a> <a href="/tags/XSS/" style="font-size: 10px;">XSS</a> <a href="/tags/centos/" style="font-size: 13.33px;">centos</a> <a href="/tags/fiddler/" style="font-size: 10px;">fiddler</a> <a href="/tags/ftp/" style="font-size: 10px;">ftp</a> <a href="/tags/git/" style="font-size: 20px;">git</a> <a href="/tags/hgdonline/" style="font-size: 10px;">hgdonline</a> <a href="/tags/http/" style="font-size: 10px;">http</a> <a href="/tags/ios/" style="font-size: 16.67px;">ios</a> <a href="/tags/linux/" style="font-size: 16.67px;">linux</a> <a href="/tags/mac/" style="font-size: 10px;">mac</a> <a href="/tags/memcache/" style="font-size: 10px;">memcache</a> <a href="/tags/mysql/" style="font-size: 13.33px;">mysql</a> <a href="/tags/nginx/" style="font-size: 16.67px;">nginx</a> <a href="/tags/php/" style="font-size: 16.67px;">php</a> <a href="/tags/php-fpm/" style="font-size: 13.33px;">php-fpm</a> <a href="/tags/phpstorm/" style="font-size: 10px;">phpstorm</a> <a href="/tags/redis/" style="font-size: 16.67px;">redis</a> <a href="/tags/session/" style="font-size: 13.33px;">session</a> <a href="/tags/session-set-save-handler/" style="font-size: 10px;">session_set_save_handler</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/ssh/" style="font-size: 10px;">ssh</a> <a href="/tags/sudo/" style="font-size: 10px;">sudo</a> <a href="/tags/table-view/" style="font-size: 10px;">table view</a> <a href="/tags/timer/" style="font-size: 10px;">timer</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a> <a href="/tags/vim/" style="font-size: 10px;">vim</a> <a href="/tags/vsftp/" style="font-size: 10px;">vsftp</a> <a href="/tags/xcode/" style="font-size: 10px;">xcode</a> <a href="/tags/yum-install/" style="font-size: 10px;">yum install</a> <a href="/tags/亲情/" style="font-size: 10px;">亲情</a> <a href="/tags/人生多艰/" style="font-size: 10px;">人生多艰</a> <a href="/tags/内存管理/" style="font-size: 10px;">内存管理</a> <a href="/tags/分享/" style="font-size: 10px;">分享</a> <a href="/tags/命令/" style="font-size: 10px;">命令</a> <a href="/tags/基友/" style="font-size: 10px;">基友</a> <a href="/tags/快捷键/" style="font-size: 10px;">快捷键</a> <a href="/tags/换届合影/" style="font-size: 10px;">换届合影</a> <a href="/tags/无法删除/" style="font-size: 10px;">无法删除</a> <a href="/tags/日历/" style="font-size: 10px;">日历</a> <a href="/tags/权限/" style="font-size: 10px;">权限</a> <a href="/tags/正则表达式/" style="font-size: 10px;">正则表达式</a> <a href="/tags/测试/" style="font-size: 10px;">测试</a> <a href="/tags/湖工大在线/" style="font-size: 10px;">湖工大在线</a> <a href="/tags/设计模式/" style="font-size: 10px;">设计模式</a> <a href="/tags/错误日志/" style="font-size: 10px;">错误日志</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul id="recent-post" class="no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"></p>
              <p class="item-title"><a href="/2016/08/08/实用shell脚本/" class="title">实用shell脚本</a></p>
              <p class="item-date"><time datetime="2016-08-08T09:36:28.000Z" itemprop="datePublished">2016-08-08</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"></p>
              <p class="item-title"><a href="/2016/07/20/Git-忽略-gitignore文件自身/" class="title">Git 忽略.gitignore文件自身</a></p>
              <p class="item-date"><time datetime="2016-07-20T02:47:44.000Z" itemprop="datePublished">2016-07-20</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"></p>
              <p class="item-title"><a href="/2016/06/04/git-rebase相关/" class="title">git rebase相关</a></p>
              <p class="item-date"><time datetime="2016-06-04T03:13:58.000Z" itemprop="datePublished">2016-06-04</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"></p>
              <p class="item-title"><a href="/2016/04/28/解决php-v和phpinfo-打印的php版本不一致问题/" class="title">解决php -v和phpinfo()打印的php版本不一致问题</a></p>
              <p class="item-date"><time datetime="2016-04-28T08:28:36.000Z" itemprop="datePublished">2016-04-28</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"></p>
              <p class="item-title"><a href="/2016/04/27/phpstorm切换上载sftp/" class="title">phpstorm切换上载sftp</a></p>
              <p class="item-date"><time datetime="2016-04-27T03:22:36.000Z" itemprop="datePublished">2016-04-27</time></p>
            </div>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/IOS学习笔记/">IOS学习笔记</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mysql/">Mysql</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Nginx/">Nginx</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHP/">PHP</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/TECH-DOC/">TECH DOC</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tech-Doc/">Tech Doc</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ios学习笔记/">ios学习笔记</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/reids/">reids</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/security/">security</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/杂谈/">杂谈</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap widget-list">
    <h3 class="widget-title">链接</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="http://veryyoung.me/">Veryyoung</a>
          </li>
        
          <li>
            <a href="http://helloco.github.io">Helloco</a>
          </li>
        
          <li>
            <a href="https://ironmantony.github.io/">Ironman</a>
          </li>
        
      </ul>
    </div>
  </div>


  
  <div id="toTop" class="fa fa-chevron-up"></div>
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; Tue Jul 28 2015 08:00:00 GMT+0800 (CST) - 2016 路人-戊<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>.
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1255960260'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s4.cnzz.com/z_stat.php%3Fid%3D1255960260%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>



    </div>
  </div>
</footer>

    

<script type="text/javascript">
  var duoshuoQuery = {short_name:"路人-戊"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>


<script src="//ajax.useso.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>